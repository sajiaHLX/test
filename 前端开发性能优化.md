###  前端开发性能优化

减少HTTP请求次数和请求大小

代码优化

​	有利于SEO

​	有利于扩展维护

​	有利于减少性能消耗

​	..........

DNS及HTTP通信方式的优化





- **1.在JS中尽量减少闭包的使用**

	- 因为闭包会产生私有作用域，不销毁的栈内存，增大内存的消耗
- A:循环给元素做事件绑定的时候，尽可能的把后期需要的信息（例如索引）存储到元素的自定义属性上，而不是创建闭包存储
		- B:可以在最外层形成一个闭包，把一些后续需要的公共信息进行存储，而不是每一个方法都创建闭包（例如单例模式）
- C:尽可能的手动释放不被占用的内存
		- ............

- **2.尽量合并css和JS文件（把需要引入的css文件合并为一个，JS也合并为一个）**

	- 尽量减少HTTP请求的次数，尽可能的把合并后的代码进行压缩，减少HTTP请求资源的大小
- A:webpack这种自动化构建工具，可以帮我们实现代码的压缩和合并（工程化开发）
		- B:在移动端开发（或者追求高性能的PC开发【例如百度首页】），如果css或者JS不是需要很多，我们可以选择把css和js编程内嵌式（也就是代码直接写在HTML中）

- **3.尽量使用字体图标或者SVG图标，来代替传统的PNG等格式的图片**

	- 因为字体图标等是矢量图（基于代码编写出来的），放大不会变形，而且渲染速度快，相对比位图要小一些

- **4.减少对DOM的操作**

	- 减少DOM的重绘和回流（重排）
- A:关于重排的分离读写
		- B:使用文档碎片或者字符串拼接做数据绑定（DOM的动态创建）

- **5.在JS中避免嵌套循环和死循环**

	- 嵌套循环会额外增加很多循环次数，死循环会将浏览器卡死

- **6.采用图片的”懒加载“（延迟加载）**

	- 目的是为了减少页面第一次加载过程中HTTP的请求次数，让页面打开更快

	步骤：开始加载页面的时候，所有的真实图片都不去发送HTTP请求加载，而是给一张占位的背景图，当页面加载完，并且图片在可视区域内我们再去做图片加载

- **7.利用浏览器和服务器端的缓存技术（304缓存）**

	- 把一些不经常用更新的静态资源文件做缓存处理（例如：JS，CSS，静态图片等都可以做缓存）也是为了减少HTTP请求大小，让获取速度更快

- **8.尽可能使用事件委托（事件代理）来处理事件绑定的操作**

	- 减少DOM的频繁操作，其中包括给每一个DOM元素做事件绑定

- **9.尽量减少CSS表达式的使用（expression）**

	```css
	#myDiv{
	    position:absolute;
	    width:100px;
	    height:100px;
	    left:expression(document.body.offsetWidth-110+'px');
	    top:expression(document.body.offsetHeight-110+'px');
	    background:red;
	}
	```

- **10.CSS选择器解析规则是从右向左解析**

	```css
	.container .link a{
		先找到所有的A，在筛选是在.link样式类中，再次筛选是在.container样式类中的...先找到的是所有的A，操作起来是消耗性能的，我们在使用CSS选择器的时候尽量减少对标签选择器的使用
	}
	```

- **11.CSS雪碧图技术（CSS sprite/ CSS图片精灵）**

	- 把所有相对较小的资源图片汇总到一张大图上，后期我们只需要把大图加载下来，用背景定位的方式展对应的小图即可

	```css
	.bg{
	    background:url('xxx.png');
	}
	.box1{
	    bakcground-position:xxx xxx;
	}
	.box2{
	    background-position:xx xx;
	}
	<div class='bg box1'></div>
	```

- **12.减少COOKIE的使用**

	- 减少本地cookie存储内容的大小，因为客户端操作cookie的时候，这些信息总是在服务器端传来传去

- **13.页面中的数据获取采用异步编程和延迟分批加载**

	- 使用异步获取数据，是为了降低HTTP通道的堵塞，不会因为数据没有请求回来耽误下面信息的渲染，提高页面的打开速度（我们可以这样处理：需要动态绑定数据的区域先隐藏，等数据返回并且绑定完成后在让其显示）

	- 延迟分批加载类似于图片懒加载，是为了减少第一次页面加载时候的HTTP请求次数

- **14.页面中出现音视频标签，我们不让页面加载的时候就去加载这些资源（要不然页面加载就会变慢）**

	- 只需要设置preload=‘none’，等待页面加载完成，音视频播放的时候我们在去加载音视频资源

- **15.在客户端和服务端进行信息交互的时候，对于多项数据我们尽可能基于JSON格式来进行传送（JSON格式数据处理方便，资源偏小）==>相对于XML格式的传输才会有这个优势**

- **16.尽可能实现JS的封装（低耦合高内聚）**

	- 减少页面中的冗余代码（减少HTTP请求资源的大小）

- **17.CSS中设置定位后，最好使用Z-index改变盒子的层级，让所有盒子在不相同的平面上，这样后续处理的时候，性能会有一点提升**

- **18.在基于AJAX的GET请求进行数据交互的时候，根据需求可以让其产生缓存（这个缓存不是304缓存），这样下一次从相同地址获取的数据是上一次缓存的数据（但是很少用，项目中一般会刻意清除这个缓存的时候偏多）**

- **19.尽量减少对于filter滤镜属性的使用（这个属性消耗性能较大一些）**

- **20.在CSS导入的时候尽量减少使用@import导入式**

	- 因为@import是同步操作，只有把这个对应的CSS导入，才会向下加载，而link是异步操作

- **21.配置ETag**

- **22.使用window.requestAnimationFrame()代替传统的定时器动画**

	- JS中的帧动画

- **23.减少递归的使用，避免由于递归导致的栈内存嵌套（建议使用尾递归）**

- **24.避免使用iframe（不仅不好管控样式，而且相当于在A页面中加载了其他页面，消耗较大）**

- **25.利用H5中提供的localstorage本地存储或者是manifest离线缓存，做一些信息的本地存储，下一次加载页面的时候直接从本地获取，减少HTTP请求次数**

- **26.基于SCRIPT调取JS的时候，可以使用defer或者async来异步加载**



- **重量级优化：做CDN加速（烧钱机器）**
- 地域式服务器分布，在热门地域附近设置服务器机组，附近的用户访问的都是离其最近的机组（提高访问速度）

- **防抖和节流函数的使用**

	- ```javascript
		//防抖:
		debounce(func,delay){
		    return function(...args){
		        let timer=null
		        if(timer) clearTimeout(timer)
		        timer= setTimeout(()=>{
		            func.apply(this,args)
		        },delay)
		    }
		}
		```

	- ```javascript
		//节流
		function throttle(func, wait) {
		    let previous = 0;
		    return function() {
		        let now = Date.now();
		        let context = this;
		        let args = arguments;
		        
		        if (now - previous > wait) {
		            func.apply(context, args);
		            previous = now;
		        }
		    }
		}
		```

	- 

==**额外的操作**==

**1.把CSS放在body上面，js放到body下面**

​	让CSS先加载，在加载JS，先加载CSS是为了保证页面渲染的过程中，元素是带着样式渲染的，而JS一般都是用来操作DOM元素的，需要等到元素加载完再操作

**2.能用CSS搞定的绝对不用JS，能用原生JS搞定的绝对不使用插件，绝对不使用flash（除了音视频的低版本浏览器播放）**

​	CSS处理动画的性能优于JS，而且CSS中的transform变形还开启了硬件加速

**3.JS尽量减少EVAL的使用**

​	因为JS合并压缩的时候，可能会出现由于符号不完整，导致的代码执行优先级错乱的问题，EVAL处理起来消耗的性能也是偏大一点的	

**4.使用keep-alive实现客户端长连接**

**5.尽量使用设计模式来管理我们的代码（单例、构造、promise、发布订阅），便于后期管理优化代码**

**6.开启服务端的GZIP压缩**

​	可以有效减少请求资源文件的大小，其实客户端的图片资源也可以进行压缩的（但是相对于24位的位图，压缩后可能会变模糊）

**7.页面中不要出现无效的链接（利于SEO优化）**

​	一些其他的技巧：提高关键字曝光率，img需要加alt，设置meta标签，标签语义化....

**8.避免使用with语句**