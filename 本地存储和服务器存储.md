### 本地存储和服务器存储

**本地存储特性：**

- 数据存储在用户浏览器中
- 设置，读取方便，甚至页面刷新都不会丢失数据
- 容量较大，sessionStorage约5M，localStorage约20M
- 只能存储字符串，可以将对象JSON.stringify()编码后存储

**window.sessionStorage**

- 生命周期为关闭浏览器窗口
- 在同一个窗口（页面）下数据可以共享
- 以键值对的形式存储使用
- **存储数据**
	- sessionStorage.setItem(key,value)
- **获取数据**
	- sessionStorage.getItem(key)
- **删除数据**
	- sessionStorage.removeItem(key)
- **删除所有数据**
	- sessionStorage.clear()

**window.localStorage**

- 生命周期永久生效，除非手动删除，否则关闭页面也会存在
- 可以多窗口（页面）共享，同一浏览器可以共享
- 以键值对的方式存储

**本地存储**：把一些信息存储到客户端本地（主要目的很多，其中一个就是实现多页面之间的信息共享）

- 离线缓存（xxx.manifest）H5处理离线缓存还是存在一些硬伤的，所以真实项目中一般还是传统的NATIVE APP来完成这件事情
- localStorage / sessionStorage： H5中新增加的API，基于这个API可以把一些数据缓存到客户端本地（常用）
- indexedDB / webSQL ：本地数据库存储
- cookies：本地信息存储（常用）
- CacheStorage / ApplicationCache：本地缓存存储

<!--more-->

**用到本地存储的地方**：

- 本地存储都是存储到当前浏览器指定的地方，在谷歌中存储的信息在IE中获取不到，本地存储信息**无法跨浏览器进行传输**
- 存储的信息是按照域来管理的，访问京东的网站信息都存储在jd.com中，其他域的网站无法直接获取这些信息，本地存储信息**不能直接跨域访问**
 - 【页面之间的信息通信】
		- A存储信息，B页面中可以获取
		- 登录
		- 记住用户名密码
		- 购物车
		- 跳转其他页面，返回上级页面的时候停留在最后一次点击的位置
		- 、、、
 - 【做一些性能优化】
     - 把一些不经常改变的数据，在第一次从服务器端获取到之后，存储到客户端本地（记录一个存储时间），假设我们设置的有效存储期是10分钟，那么10分钟以内，我们再刷新页面，就不用向客户端发送请求了，直接从本地数据中获取展示即可，超过10分钟，重新想服务器发送请求，请求回来最新数据参考第一次，也一样存储到本地中（减轻服务器压力，对于不经常更新的数据我们可以把存储周期设置的长一点，有助于页面的第二次加载的时候，渲染速度（移动端经常做这些事情））

**登录/注册**：真实项目中的登录注册，是基于Session服务器存储的登录信息，而不是本地存储（因为本地存储不安全：明文存储，直接在浏览器的控制台中就可以查看到）

 **session和cookie的关联**

- session是服务器存储，cookie是客户端存储
- 在服务器端建立session之后，服务器和当前客户端之间会建立一个唯一的标识（session / sid），而本次存储的session信息都存放到对应的sid下（目的是为了区分不同客户端都在服务器上建立session信息，后期查找的时候，可以找到当初建立的）
- 当服务器端把一些成功或者失败的结果返回给客户端的时候，在响应头信息中会增加set-cookie（客户端的cookie）这样的字段，把sid存储到客户端的cookie信息中。HttpOnly规定当前的cookie信息只能获取使用，但是不能修改
- 当客户端在向服务器发送任何请求的时候，在请求头中，都会把cookie信息带上，传递给服务器（包含了之前存储的connect.sid）

**localStorage VS cookie**

- [cookie]
	- 兼容所有的浏览器
	- 有存储的大小限制，一般一个源（一个域下只能存储4kb内容）
	- cookie有过期时间（可以手动设置）
	- 杀毒软件或者浏览器垃圾清理都可能会把cookie信息强制删除掉
	- 在隐私或者无痕浏览模式下，是不记录cookie的
	- cookie不是严格的本地存储，因为要和服务器之间来回传输

document.cookie='';  设置cookie

- [localStorage]

	- 不兼容IE8及以下
	- 有存储的大小限制，一般一个源最多只能存储20MB左右
	- 本地永久存储，只要你不手动删除，永远存储在本地（但是我们可以基于API removeItem/clear手动清除一些自己想要删除的信息）
	- 杀毒软件或者浏览器垃圾清理会把localStorage信息删除掉
	- 在隐私或者无痕浏览模式下，是记录localStorage的
	- localStorage和服务器没有关系

	localStorage.getItem([key],[value])：[value]必须是字符串格式的（即使写的不是字符串，也会默认转换为字符串）

	localStorage.getItem([key])：通过属性名获取存储的信息

	localStorage.removeItem([key])：删除指定的存储信息

	localStorage.clear()：清除当前域下的所有信息

	localStorage.key(0)：基于索引获取指定的KEY名